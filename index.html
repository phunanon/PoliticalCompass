<!DOCTYPE HTML>
<html>
    <head>
        <title>3dPoliticalCompass</title>
        <meta name="viewport" content="width=device-width, initial-scale=0.8">
        <meta charset="UTF-8">
        <script>
//Copied from http://www.sapplycompass.com/
var questions = [[0, 1, "Freedom of big business is the best practical way a society can prosper.", 0], [0, 1, "Charity is a better way of helping those in need than social welfare.", 0], [0, -1, "Organisations and corporations cannot be trusted and need regulating by the government.", 0], [0, -1, "A government that provides for everyone is an inherently good idea.", 0], [0, -1, "The welfare system doesn't go far enough towards removing inequality.", 0], [0, 1, "Wages are usually fair, as big business knows best what a worker's labour is worth", 0], [0, 1, "It is \"human nature\" to be greedy.", 0], [0, -1, "Land should not be a commodity to be bought and sold.", 0], [0, -1, "All industry and the bank should be nationalised.", 0], [0, 1, "\"Exploitation\" is an outdated term, as the struggles of 1800s capitalism doesn't exist anymore.", 0], [0, 1, "Communism is an ideal that can never work in practice.", 0], [0, 1, "Taxation of the wealthy is a bad idea, society would be better off without it.", 0], [0, 1, "The harder you work, the more you progress up the social ladder.", 0], [0, -1, "Class is the primary division of society.", 0], [0, -1, "Economic inequality is too high in the world.", 0], [1, -1, "The government should be less involved in the day to day life of its citizens.", 0], [1, 1, "Sometimes it is right that the government may spy on its citizens, to combat extremists and terrorists.", 0], [1, 1, "Authority figures, if morally correct, are a good thing for society.", 0], [1, 1, "Strength is necessary for any government to succeed.", 0], [1, 1, "Only the government can fairly and effectively regulate organisations.", 0], [1, -1, "Without democracy a society is nothing.", 0], [1, -1, "Jury Nullification should be legal.", 0], [1, -1, "The smaller the government, the freer the people.", 0], [1, 1, "As things are right now, society requires structure and bureaucracy in order to function.", 0], [1, 1, "Mandatory IDs should be used to ensure public safety.", 0], [1, -1, "The government should only provide emergency services and law enforcement, no more.", 0], [1, 1, "In times of crisis, safety becomes more important than civil liberties.", 0], [1, -1, "The police exist to protect the people, not uphold the status-quo by force.", 0], [1, -1, "State schools are a bad idea, because our state shouldn't be influencing our children.", 0], [1, 1, "If you have nothing to hide, you have nothing to fear.", 0], [2, -1, "Homosexuality is against my values.", 0], [2, -1, "Transgender individuals should not be able to adopt children.", 0], [2, 1, "Two consenting individuals should be able to do whatever they want with each other, even if it makes me uncomfortable.", 0], [2, 1, "An individual’s body is their own property, and should be able to do anything they desire to it.", 0], [2, -1, "Drugs are harmful and should be banned.", 0], [2, -1, "The death penalty should exist for certain crimes.", 0], [2, -1, "Non-violent crimes should still be punished.", 0], [2, -1, "Without religion one can not be moral.", 0], [2, -1, "Parents should hold absolute power over their children, as they are older and more experienced.", 0], [2, 1, "A person should be able to worship whomever or whatever they want.", 0], [2, 1, "Nudism is perfectly natural.", 0], [2, 1, "Animals deserve certain universal rights.", 0], [2, 1, "Gender is a social construct, not a natural state of affairs.", 0], [2, -1, "Multiculturalism is bad.", 0], [2, 1, "Laws based on cultural values, rather than ethical ones, aren’t justice.", 0], [2, 1, "Autonomy of body extends even to minors, the mentally ill and serious criminals.", 0]];
var r = [0, 0, 0]; //Each value tallied as ratios (eg. 1 econ, 2 auth, 1 prog)

var c, ctx, cw, ch;

function pageLoad ()
{
  //Shuffle array
    fy(questions);
  //Prepare canvas
    c = gE("compass");
    ctx = c.getContext("2d");
    ctx.imageSmoothingEnabled = false;
    ctx.translate(0.5, 0.5);
    cw = c.width;
    ch = c.height;
  //Load questions
    var axis = ["econ", "auth", "prog"];
    var answers = ["Strongly Agree", "Agree", "Neutral", "Disagree", "Strongly Disagree"];
    qbox = document.getElementsByTagName("questions")[0];
    for (var q = 0, qlen = questions.length; q < qlen; ++q) {
      //Tally values
        ++r[questions[q][0]];
      //Display on page
        var html = '<question class="'+ axis[questions[q][0]] +'"><n>'+ (q+1) +'/'+ qlen +'</n><q>'+ questions[q][2] +'</q><form>';
        for (var s = 0; s < 5; ++s) {
            html += '<input onchange="save('+ q +', '+ s +')" name="q'+ q +'" type="radio" id="'+ q +'_'+ s +'"'+ (s == 2 ? ' checked' : '') +'><label for="'+ q +'_'+ s +'">'+ answers[s] +'</label>';
        }
        html += '</form></question>';
        qbox.innerHTML += html;
    }
    r[0] = (cw/r[0]) / 4;
    r[1] = (ch/r[1]) / 4;
    r[2] = (255/r[2]);
  //Begin draw
    updateCompass();
}

function save (q, a)
{
    questions[q][3] = -questions[q][1] * (a - 2);
  //Focus on next
    /*var f = gE((q + 1) +'_0');
    f.focus();
    window.scrollTo(0, f.offsetTop);*/
  //Redraw
    updateCompass();
}

function getPoint (x, y)
{
    return [cw/2 + r[0]*x, ch/2 - r[1]*y];
}

var font = 32;
function updateCompass ()
{
  //Recount question values
    var v = [0, 0, 0]; //econ, auth, prog
    var w = [0, 0, 0, 0, 0, 0]; //+econ, +auth, +prog, -econ, -auth, -prog
    for (var q = 0, qlen = questions.length; q < qlen; ++q) {
        a = questions[q][3];
        v[questions[q][0]] += a;
        w[questions[q][0] + (a > 0 ? 0 : 3)] += Math.abs(a);
    }
  //Clear
    ctx.fillStyle = "#fff";
    ctx.fillRect(0, 0, cw, ch);
  //Shade
    ctx.fillStyle = '#ccc';
    ctx.beginPath();
    ctx.moveTo(cw/2 - r[0]*w[3], ch/2); // -econ
    ctx.lineTo(cw/2, ch/2 - r[1]*w[1]); // +auth
    ctx.lineTo(cw/2 + r[0]*w[0], ch/2); // +econ
    ctx.lineTo(cw/2, ch/2 + r[1]*w[4]); // -auth
    ctx.closePath();
    ctx.fill();
  //Grid
    ctx.strokeStyle = '#eee';
    for (var x = 0; x < cw; x += r[0]) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, ch);
        ctx.stroke();
    }
    for (var y = 0; y < ch; y += r[1]) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(cw, y);
        ctx.stroke();
    }
  //Axis
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(0, ch / 2);
    ctx.lineTo(cw, ch / 2);
    ctx.stroke();
    ctx.moveTo(cw / 2, 0);
    ctx.lineTo(cw / 2, ch);
    ctx.stroke();
    ctx.lineWidth = 1;
  //Progression circles
    ctx.fillStyle = "rgba(0, 0, 255, .5)";
    ctx.beginPath();
    ctx.arc(cw/2, ch/2, (font/5)*w[2], Math.PI*1.75, Math.PI*0.75);
    ctx.closePath();
    ctx.stroke();
    ctx.fill();
    
    ctx.fillStyle = "rgba(255, 0, 0, .5)";
    ctx.beginPath();
    ctx.arc(cw/2, ch/2, (font/5)*w[5], Math.PI*0.75, Math.PI*1.75);
    ctx.closePath();
    ctx.stroke();
    ctx.fill();
  //Point
    c = r[2]*v[2];
    p = getPoint(v[0], v[1]);
    var x = p[0], y = p[1];
    
    ctx.fillStyle = "rgba(255, 255, 255, .5)";
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.arc(x, y, font/5, 0, Math.PI*2);
    ctx.closePath();
    ctx.stroke();
    ctx.fill();
    ctx.lineWidth = 1;
  //Text
    ctx.font = font +"px mono";
    x = (v[0] > 0 ? font : cw - font * 6);
    ctx.fillStyle = "#4b4"; ctx.fillText("econ "+ v[0], x, font * 2);
    ctx.fillStyle = "#e44"; ctx.fillText("auth "+ v[1], x, font * 3);
    ctx.fillStyle = "#44f"; ctx.fillText("prog "+ v[2], x, font * 4);
}

function fy (a,b,c,d) { c=a.length;while(c)b=Math.random()*c--|0,d=a[c],a[c]=a[b],a[b]=d }
function gE (e) { return document.getElementById(e); }
        </script>
        <style>
* {
    padding: 0;
    margin: 0;
    font-family: sans;
}

question {
    display: grid;
    grid-template-columns: 50% 50%;
    width: 50%;
    margin: .5rem;
    padding: .5rem;
    border: .1rem solid #000;
    position: relative;
}
question.econ { background-color: #8f8; }
question.auth { background-color: #f88; }
question.prog { background-color: #88f; }
question q {
    display: block;
    margin: 1rem;
    grid-column: 1 / 2;
}
question input[type="radio"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
}
question label {
    display: block;
    cursor: pointer;
    margin: .25rem;
    padding: .25rem;
    grid-column: 2 / 3;
}
question input[type="radio"]:focus+label, question input[type="radio"]:hover+label {
    background-color: #ff8;
}
question input[type="radio"]:checked+label {
    background-color: #aaf;
}
question n {
    position: absolute;
    bottom: 1rem;
    left: 1rem;
    font-size: 2rem;
    color: rgba(0, 0, 0, .1);
}

canvas {
    position: fixed;
    top: 0;
    right: 0;
    width: 50%;
    height: 100%;
}

@media (max-width: 40rem) {
    question {
        width: unset;
    }
    #compass {
        width: 100%;
        height: 50%;
        top: 50%;
        bottom: 0;
    }
}
        </style>
    </head>
    <body onload="pageLoad()">
        <questions></questions>
        <canvas id="compass" width="640" height="640"></canvas>
    </body>
</html>
